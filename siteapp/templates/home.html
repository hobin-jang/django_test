{% extends 'base.html' %}
{% block content %}
<div class="container">
  {% for board in Board %}
    <a href="{% url 'board' board.id %}">{{board.title}}</a>
  {% endfor %}
  <br><br>
  
  <!--정렬-->
  <form id="searchForm" method="GET" action="{% url 'home' %}">
  <div class="col-4">
    <select id="sort-select" onchange = "location = this.value;">
      <option value="">정렬기준</option>
      <option value="/">최신순</option>
      <option value="?sort=likes">좋아요순</option>
      <option value="?sort=comments">댓글순</option>
    </select>
  </div>
  </form>

  <!--글(최신순 정렬)-->
  {% for post in posts %}
    <a href="{% url 'detail' post.id %}">{{post.title}}</a>
    - {{post.writer}} - {{post.date | date:'Y-m-d H:i'}} - (좋아요 : {{post.like_count}})
    - (댓글 : {{post.comment_count}})
    - 게시판 : <a href="{% url 'board' post.board.id %}">{{post.board.title}}</a>
    <br><br>
  {% endfor %}

  <!--pagenation-->
  {% if posts.has_previous %}
    <a href="?page=1">First</a>
    <a href="?page={{posts.previous_page_number}}">Previous</a>
  {% endif %}

  <span>{{posts.number}} / {{posts.paginator.num_pages}}</span>

  {% if posts.has_next %}
    <a href="?page={{posts.next_page_number}}">Next</a>
    <a href="?page={{posts.paginator.num_pages}}">Last</a>
  {% endif %}
</div>
{% endblock %}

{% block scripts %}
<script type='text/javascript'>
$(document).ready(function(){
    $(".page-link").on('click', function() {
        $("#page").val($(this).data("page"));
        $("#searchForm").submit();
    });

    $(".sort").on('change', function() {
        $("#sort").val($(this).val());
        $("#page").val(1);
        $("#searchForm").submit();
    });
});
</script>
{% endblock %}
